<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.6647f095550c60566ecf.css">html{font-size:100}body{margin:0 0 0 calc(100vw - 100%);color:#222;line-height:1.625;font-size:1rem;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}body,h1,h2,h3,h4,h5,h6{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}h1,h2,h3,h4,h5,h6{font-weight:600}h1{font-size:2.5rem;line-height:3.25rem;margin-top:6.5rem;margin-bottom:1.625rem}h2{font-size:1.6875rem;line-height:2.4375rem}h2,h3{margin-top:3.25rem;margin-bottom:.8125rem}h3{font-size:1.375rem;line-height:1.625rem}h4{font-size:1.2rem;margin-top:2.4375rem}h4,h5{line-height:1.625rem;margin-bottom:.8125rem}h5,h6{font-size:1rem;margin-top:4.0625rem}h6{line-height:1.625rem;margin-bottom:.8125rem}img{max-width:100%;margin:inherit auto}hr,img{border:0;display:block}hr{color:#222;height:26px;margin:3.25rem auto;background-size:100% 26px;background-image:linear-gradient(180deg,transparent 1px,transparent 11px,#222 0,#222 15px,transparent 0,transparent 26px);width:6.25rem}a{color:#5d93ff;text-decoration:none}a:active,a:focus,a:hover{color:#f7a046}b,strong{font-weight:600}ul{list-style:square;margin-bottom:1.625rem}ul li{padding:0 .3125rem;margin-bottom:.625rem}p{line-height:1.625rem;margin-bottom:1.625rem}blockquote{padding:0;font-style:italic;text-align:center}figure{display:block;width:100%;height:auto}figcaption{line-height:1.21875rem;margin-top:.40625rem;color:#222;font-size:.875rem;font-style:italic;margin-bottom:0;text-align:center}.anchor{margin-left:-1.875rem!important;padding-right:.875rem!important}@media screen and (min-width:685px){figure.float-left,figure.float-right{max-width:19.375rem;padding:0 1.625rem}.float-right{float:right}.float-left{float:left}}code[class*=language-],pre[class*=language-]{color:#657b83;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#073642}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdf6e3}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#93a1a1}.token.punctuation{color:#586e75}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#268bd2}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string,.token.url{color:#2aa198}.token.entity{color:#657b83;background:#eee8d5}.token.atrule,.token.attr-value,.token.keyword{color:#859900}.token.class-name,.token.function{color:#b58900}.token.important,.token.regex,.token.variable{color:#cb4b16}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.Author-module--author__photo--HnDWV{display:inline-block;margin-bottom:0;border-radius:50%;background-clip:padding-box}.Author-module--author__title--ZztQd{font-size:1.125rem;font-weight:600;line-height:1.82813rem;margin:.8125rem 0}.Author-module--author__title-link--BY7f8,.Author-module--author__title-link--BY7f8:focus,.Author-module--author__title-link--BY7f8:hover{color:#222}.Author-module--author__subtitle--3hbMX{color:#888;line-height:1.625rem;margin-bottom:1.625rem}.Icon-module--icon--1T2h2{display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor;font-style:normal;font-weight:400;speak:none;margin-right:.2em;text-align:center;font-variant:normal;text-transform:none;line-height:1em;margin-left:.2em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.Contacts-module--contacts--3fb7G{margin-bottom:1.625rem}.Contacts-module--contacts__list--27zok{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row wrap;-webkit-box-flex:0;flex-grow:0;flex-shrink:0;list-style:none;padding:0;margin:.625rem -.1875rem;width:8.75rem}.Contacts-module--contacts__list-item--1Adud{padding:0;margin:.25rem;display:-webkit-box;display:flex;align-content:center;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;height:35px;width:2.1875rem;line-height:2.1875rem;border-radius:50%;text-align:center;border:1px solid #ebebeb}.Contacts-module--contacts__list-item-link--2L60c{border:0;display:-webkit-box;display:flex;color:#222}.Contacts-module--contacts__list-item-link--2L60c:focus,.Contacts-module--contacts__list-item-link--2L60c:hover{color:#5d93ff}.Copyright-module--copyright--1YLES{color:#b6b6b6;font-size:.875rem}.Menu-module--menu--2aN3O{margin-bottom:1.625rem}.Menu-module--menu__list--1uKDu{list-style:none;padding:0;margin:0}.Menu-module--menu__list-item--27cxj{padding:0;margin:.625rem 0}.Menu-module--menu__list-item-link--29Sd-{font-size:1rem;color:#222;font-weight:400;border:0}.Menu-module--menu__list-item-link--29Sd-:focus,.Menu-module--menu__list-item-link--29Sd-:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.Menu-module--menu__list-item-link--active--2HzKy{color:#222;border-bottom:1px solid #222}.Sidebar-module--sidebar--1zM7S{width:100%}.Sidebar-module--sidebar__inner--2Tprz{position:relative;padding:1.5625rem 1.25rem 0}@media screen and (min-width:685px){.Sidebar-module--sidebar--1zM7S{width:calc(41.625% - 1.09375rem)}.Sidebar-module--sidebar--1zM7S:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--1zM7S:last-child{margin-right:0}.Sidebar-module--sidebar--1zM7S:nth-child(12n){margin-right:0;float:right}.Sidebar-module--sidebar--1zM7S:nth-child(12n+1){clear:both}.Sidebar-module--sidebar__inner--2Tprz{padding:1.875rem 1.25rem 0}.Sidebar-module--sidebar__inner--2Tprz:after{background:#e6e6e6;background:-webkit-gradient(linear,left top,left bottom,from(#e6e6e6),color-stop(48%,#e6e6e6),to(#fff));background:linear-gradient(180deg,#e6e6e6 0,#e6e6e6 48%,#fff);position:absolute;content:"";width:.0625rem;height:540px;top:30px;right:-10px;bottom:0}}@media screen and (min-width:960px){.Sidebar-module--sidebar--1zM7S{width:calc(33.3% - 1.25rem)}.Sidebar-module--sidebar--1zM7S:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Sidebar-module--sidebar--1zM7S:last-child{margin-right:0}.Sidebar-module--sidebar--1zM7S:nth-child(3n){margin-right:0;float:right}.Sidebar-module--sidebar--1zM7S:nth-child(3n+1){clear:both}.Sidebar-module--sidebar__inner--2Tprz{padding:2.5rem}}.Layout-module--layout--EpQHE{max-width:66.875rem;margin-left:auto;margin-right:auto}.Layout-module--layout--EpQHE:before{content:"";display:table}.Layout-module--layout--EpQHE:after{content:"";display:table;clear:both}.Feed-module--feed__item--Bm0MP{margin-bottom:2.03125rem}.Feed-module--feed__item--Bm0MP:last-child{margin-bottom:.8125rem}.Feed-module--feed__item-title--34sOw{font-size:1.6875rem;line-height:2.4375rem;margin-top:0;margin-bottom:.8125rem}.Feed-module--feed__item-title-link--2qfTF{color:#222}.Feed-module--feed__item-title-link--2qfTF:focus,.Feed-module--feed__item-title-link--2qfTF:hover{color:#222;border-bottom:1px solid #222}.Feed-module--feed__item-description--2_Zuy{font-size:1rem;line-height:1.625rem;margin-bottom:1.21875rem}.Feed-module--feed__item-meta-time--3hc6b{font-size:.875rem;color:#222;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-divider--2GeAw{margin:0 .3125rem}.Feed-module--feed__item-meta-category-link--lAu1I{font-size:.875rem;color:#f7a046;font-weight:600;text-transform:uppercase}.Feed-module--feed__item-meta-category-link--lAu1I:focus,.Feed-module--feed__item-meta-category-link--lAu1I:hover{color:#5d93ff}.Feed-module--feed__item-readmore--rMfbv{font-size:1rem;color:#5d93ff}.Feed-module--feed__item-readmore--rMfbv:focus,.Feed-module--feed__item-readmore--rMfbv:hover{color:#5d93ff;border-bottom:1px solid #5d93ff}.Page-module--page--V2155{margin-bottom:3.25rem}.Page-module--page__inner--3xzwp{padding:1.5625rem 1.25rem}.Page-module--page__title--t1zKX{font-size:2.5rem;font-weight:600;line-height:3.25rem;margin-top:0;margin-bottom:2.35625rem}.Page-module--page__body--1A7TB{font-size:1rem;line-height:1.625rem;margin:0 0 1.625rem}@media screen and (min-width:685px){.Page-module--page--V2155{width:calc(58.275% - .78125rem)}.Page-module--page--V2155:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--V2155:last-child{margin-right:0}.Page-module--page--V2155:nth-child(12n){margin-right:0;float:right}.Page-module--page--V2155:nth-child(12n+1){clear:both}.Page-module--page__inner--3xzwp{padding:1.875rem 1.25rem}}@media screen and (min-width:960px){.Page-module--page--V2155{width:calc(66.6% - .625rem)}.Page-module--page--V2155:nth-child(1n){float:left;margin-right:1.875rem;clear:none}.Page-module--page--V2155:last-child{margin-right:0}.Page-module--page--V2155:nth-child(3n){margin-right:0;float:right}.Page-module--page--V2155:nth-child(3n+1){clear:both}.Page-module--page__inner--3xzwp{padding:2.5rem 2.1875rem}}.Pagination-module--pagination--3T_m0{margin-top:3.25rem;display:-webkit-box;display:flex}.Pagination-module--pagination__prev--3tRFv{width:50%;text-align:left}.Pagination-module--pagination__prev-link--2vesn{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__prev-link--2vesn:focus,.Pagination-module--pagination__prev-link--2vesn:hover{color:#5d93ff}.Pagination-module--pagination__prev-link--disable--1Fxw2{pointer-events:none;color:#bbb}.Pagination-module--pagination__next--19bJd{width:50%;text-align:right}.Pagination-module--pagination__next-link--3ln7y{color:#f7a046;font-size:1.625rem;font-weight:700}.Pagination-module--pagination__next-link--3ln7y:focus,.Pagination-module--pagination__next-link--3ln7y:hover{color:#5d93ff}.Pagination-module--pagination__next-link--disable--AsM50{pointer-events:none;color:#bbb}.Author-module--author--2kf8a{border-top:1px solid #e6e6e6;max-width:40rem;padding-top:1.25rem;line-height:1.625rem;margin-top:1.625rem;margin-bottom:3.25rem}.Author-module--author__bio-twitter--MufFK{display:block;text-decoration:underline}@media screen and (min-width:685px){.Author-module--author--2kf8a{margin-left:auto;margin-right:auto}}.Content-module--content--1tfQQ{max-width:59.0625rem;padding:0 .9375rem;margin:0 auto}.Content-module--content__title--1qFLI{font-size:2rem;max-width:40rem;font-weight:600;text-align:center;line-height:2.68125rem;margin:1.625rem auto 0}.Content-module--content__body--2bfha figure{margin-bottom:1.625rem}.Content-module--content__body--2bfha figure blockquote{font-style:italic;text-align:center;margin-top:0;padding:1.625rem 0}.Content-module--content__body--2bfha figure blockquote p{max-width:40rem;font-size:1.6817rem;margin-top:0;margin-bottom:1.625rem;line-height:2.4375rem}.Content-module--content__body--2bfha a{text-decoration:underline}.Content-module--content__body--2bfha *{max-width:40rem;margin-left:auto;margin-right:auto}.Content-module--content__body--2bfha img{max-width:100%}@media screen and (min-width:960px){.Content-module--content--1tfQQ{padding:0}.Content-module--content__title--1qFLI{font-size:3rem;line-height:3.65625rem;margin-top:3.65625rem;margin-bottom:2.4375rem}.Content-module--content__body--2bfha,.Content-module--content__body--2bfha p{font-size:1.125rem;line-height:1.82813rem;margin-bottom:1.82813rem}}.Meta-module--meta__date--3FNDv{font-style:italic}.Tags-module--tags--1oNz4{margin-bottom:.8125rem}.Tags-module--tags__list--2UTD-{list-style:none;margin:0 -.625rem;padding:0}.Tags-module--tags__list-item--b7tap{display:inline-block;margin:.625rem .3125rem}.Tags-module--tags__list-item-link--1hQL0{display:inline-block;height:35px;padding:0 1.5rem;line-height:2.1875rem;border:1px solid #e6e6e6;text-decoration:none;border-radius:1.25rem;color:#222}.Tags-module--tags__list-item-link--1hQL0:focus,.Tags-module--tags__list-item-link--1hQL0:hover{color:#5d93ff}.Post-module--post__comments--2T8dL,.Post-module--post__footer--1BvmJ{max-width:40rem;margin:0 auto;padding:0 .9375rem}.Post-module--post__home-button--3zx_9{display:block;max-width:5.625rem;height:35px;padding:0 1.5rem;line-height:2.1875rem;text-align:center;color:#222;border:1px solid #e6e6e6;border-radius:1.25rem;font-size:1rem;font-weight:400;margin-left:auto;margin-right:auto;margin-top:1.625rem}.Post-module--post__home-button--3zx_9:focus,.Post-module--post__home-button--3zx_9:hover{color:#5d93ff}@media screen and (min-width:960px){.Post-module--post__comments--2T8dL,.Post-module--post__footer--1BvmJ{padding:0}.Post-module--post__home-button--3zx_9{position:fixed;max-width:auto;margin:0;top:30px;left:30px}}</style><meta name="generator" content="Gatsby 2.18.12"/><link rel="alternate" type="application/rss+xml" title="Develop To be a Developer" href="/rss.xml"/><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-154589980-1"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-154589980-1', {"send_page_view":false});
      }
      </script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="icon" href="/icons/icon-48x48.png?v=c350d9728436a4feca3b13ccd34c22de"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#F7A046"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=c350d9728436a4feca3b13ccd34c22de"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=c350d9728436a4feca3b13ccd34c22de"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=c350d9728436a4feca3b13ccd34c22de"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=c350d9728436a4feca3b13ccd34c22de"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=c350d9728436a4feca3b13ccd34c22de"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=c350d9728436a4feca3b13ccd34c22de"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=c350d9728436a4feca3b13ccd34c22de"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=c350d9728436a4feca3b13ccd34c22de"/><title data-react-helmet="true">Router Api 뜯어보기 - Develop To be a Developer</title><meta data-react-helmet="true" name="description" content="React Router를 학습하기 위해 React Router를 Customizing한 블로그를 뒤져가며 나도 같이 만들어보며 원리를 이해하고자 학습하고 이렇게 정리하고자 한다."/><meta data-react-helmet="true" property="og:site_name" content="Router Api 뜯어보기 - Develop To be a Developer"/><meta data-react-helmet="true" property="og:image" content="https://ssangq.netlify.com//photo.jpg"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Router Api 뜯어보기 - Develop To be a Developer"/><meta data-react-helmet="true" name="twitter:description" content="React Router를 학습하기 위해 React Router를 Customizing한 블로그를 뒤져가며 나도 같이 만들어보며 원리를 이해하고자 학습하고 이렇게 정리하고자 한다."/><meta data-react-helmet="true" name="twitter:image" content="https://ssangq.netlify.com//photo.jpg"/><link as="script" rel="preload" href="/webpack-runtime-1b8a18eb707690299638.js"/><link as="script" rel="preload" href="/netlify-identity-widget-6611d108b42a589f4dd8.js"/><link as="script" rel="preload" href="/app-c3d9d4a44345fa6b1fa1.js"/><link as="script" rel="preload" href="/styles-aa840c26b1d65be8accb.js"/><link as="script" rel="preload" href="/commons-03b9a88ce9f91af71312.js"/><link as="script" rel="preload" href="/component---src-templates-post-template-js-9494a2a4c0af5d00f4bc.js"/><link as="fetch" rel="preload" href="/page-data\posts\custom-react-router\page-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="Layout-module--layout--EpQHE"><div><a class="Post-module--post__home-button--3zx_9" href="/">All Articles</a><div><div class="Content-module--content--1tfQQ"><h1 class="Content-module--content__title--1qFLI">Router Api 뜯어보기</h1><div class="Content-module--content__body--2bfha"><p>React Router를 학습하기 위해 React Router를 Customizing한 블로그를 뒤져가며 나도 같이 만들어보며 원리를 이해하고자 학습하고 이렇게 정리하고자 한다.</p>
<h2 id="react-router"><a href="#react-router" aria-label="react router permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React Router</h2>
<p>React Router Dom Library를 사용하면서 React Router가 어떤식으로 동작하는지 궁금했다. 함께 공부하는 분이 이전에 학습하고 만들어봤던 custom router를 참고해서 일단 따라 만들어보며 이해하려고 노력했다. 사실 React Router와 완전히 같지는 않지만 사용이 상당히 비슷하기 때문에 몇몇 Api를 제외하고는 내부 동작 또한 비슷할 것으로 생각된다. 차근 차근 정리해보려한다.</p>
<h3 id="필요한-libraries"><a href="#%ED%95%84%EC%9A%94%ED%95%9C-libraries" aria-label="필요한 libraries permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>필요한 libraries</h3>
<p>먼저 Custom Router를 만들기 위해서는 <a href="https://www.npmjs.com/package/history" target="_blank" rel="nofollow noopener noreferrer">history</a>, <a href="https://www.npmjs.com/package/querystringify" target="_blank" rel="nofollow noopener noreferrer">querystringify</a> libraries가 필요하다. <strong>history</strong> library는 브라우저의 history 즉, 페이지 이동의 정보를 관리하는 library이고, <strong>querystringify</strong>는 말 그대로 URL의 query string을 파싱해주는 작업을 도와준다.</p>
<h3 id="router를-만들기에-앞서"><a href="#router%EB%A5%BC-%EB%A7%8C%EB%93%A4%EA%B8%B0%EC%97%90-%EC%95%9E%EC%84%9C" aria-label="router를 만들기에 앞서 permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Router를 만들기에 앞서</h3>
<p>일단 현재 경로와 같은 Routing 정보는 전역에서 접근이 가능해야 Link와 Route가 제 기능을 다 할 수 있을 것이다. 이를 위해 여기서는 Context Api를 사용해 routing 정보를 전역에서 접근할 수 있게 한다.</p>
<h3 id="custom-router"><a href="#custom-router" aria-label="custom router permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Custom Router</h3>
<h4 id="1-location-정보-분석을-도와주는-함수"><a href="#1-location-%EC%A0%95%EB%B3%B4-%EB%B6%84%EC%84%9D%EC%9D%84-%EB%8F%84%EC%99%80%EC%A3%BC%EB%8A%94-%ED%95%A8%EC%88%98" aria-label="1 location 정보 분석을 도와주는 함수 permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Location 정보 분석을 도와주는 함수</h4>
<p>현재 브라우저 Location (URL 내부의) 정보를 쪼개는 util 함수를 먼저 만든다.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">import qs from &#39;querystringify&#39;;

export function locationToRoute(location) {
  // location comes from the history package
  return {
    path: location.pathname,
    hash: location.hash,
    query: qs.parse(location.search),
  };
}</code></pre></div>
<p>인자로 location 정보를 받으면, location의 프로퍼티인 pathname, hash, search 정보를 추후 사용하기 쉽게 객체로 저장하도록 한다.</p>
<h4 id="2-router-context"><a href="#2-router-context" aria-label="2 router context permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Router Context</h4>
<p>이제 Router 정보를 전역에서 접근할 수 있도록 Context Api를 사용해 만든다.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">import React from &quot;react&quot;;
import { createBrowserHistory } from &quot;history&quot;;
import { locationToRoute } from &quot;./utils&quot;;

export const history = createBrowserHistory();

export const RouterContext = React.createContext({
  route: locationToRoute(history.location),
});</code></pre></div>
<p>먼저 history library에서 createBrowserHistory Api를 사용해 새로운 browser history를 만든다. 그리고 새로운 Context를 만드는데, <strong>route</strong> 프로퍼티에 현재 location을 저장하는 객체를 Context 초기값으로 설정해준다. <strong>route</strong> 프로퍼티의 값은 util 함수로 만들었던 <code class="language-text">locationToRoute</code>에 history.location을 인자로 넣어 결과 값을 저장한다.
이제 useContext로 context를 불러 현재 path, hash, query 값에 접근할 수 있다.</p>
<h4 id="3-route와-link-component"><a href="#3-route%EC%99%80-link-component" aria-label="3 route와 link component permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Route와 Link Component</h4>
<p>React Route의 주 기능을 담당하는 <code class="language-text">Route</code>와 <code class="language-text">Link</code> 컴포넌트를 만들 차례다. </p>
<p><code class="language-text">Route</code> 컴포넌트는 url에 제공되는 path가 일치할 경우 컴포넌트를 띄우는 작업을 수행한다.
<code class="language-text">Link</code> 컴포넌트는 전체 페이지를 Re-loading하지 않고 <code class="language-text">history</code> api를 통해 URL의 path를 바꿔주는 작업을 수행한다.</p>
<p>이렇게 Link가 전체 페이지의 Re-loading 없이 path를 바꿔주고, Route 컴포넌트에서는 path에 따라 해당하는 컴포넌트만 render해주는 작업으로 이뤄진다.
그러면 useContext를 사용해 위에서 만든 Context의 데이터를 사용해 <code class="language-text">Route</code>와 <code class="language-text">Link</code> 컴포넌트를 만들어보자.</p>
<h5 id="router"><a href="#router" aria-label="router permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Router</h5>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">import React from &quot;react&quot;;
import { RouterContext } from &quot;./context&quot;;

export function Route({ path, children }) {
  // Extract route from RouterContext
  const { route } = React.useContext(RouterContext);

  // Return null if the supplied path doesn&#39;t match the current route path
  if (route.path !== path) {
    return null;
  }

  return children;
}</code></pre></div>
<p>Router 컴포넌트는 2개의 props를 받는데, <code class="language-text">path와</code> <code class="language-text">children</code>이다. <code class="language-text">children</code>은 <code class="language-text">Route</code>의 자식요소로 전달된 컴포넌트를 그대로 가져와서 렌더링 하기위함이고, <code class="language-text">path</code>는 위에서 보다시피 Context로 가져온 route 정보에서 현재 path와 비교 후 인자로 들어온 path와 Context에 있는 path가 일치하지 않으면 새로운 뷰 (children이 갖고 있는)를 출력해준다.</p>
<h5 id="link"><a href="#link" aria-label="link permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Link</h5>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">import React from &quot;react&quot;;
import { RouterContext, history } from &quot;./context&quot;;

export function Link(props) {
  const { to, onClick, children } = props;

  // Extract route from RouterContext
  const { route } = React.useContext(RouterContext);
  const handleClick = (e) =&gt; {
    e.preventDefault();

    // Dont&#39; navigate if current path
    if (route.path === to) {
      return;
    }

    // Trigger onClick prop manually
    if (onClick) {
      onClick(e);
    }

    // Use history API to navigate page
    history.push(to)
  };

  return (
    &lt;a {...props} onClick={handleClick}&gt;
      {children}
    &lt;/a&gt;
  );
}</code></pre></div>
<p>Link는 <code class="language-text">to</code>, <code class="language-text">onClick</code>, <code class="language-text">children</code> props를 받는다. <code class="language-text">to</code>는 URL을 변경할 path를 의미한다. 현재 Link 컴포넌트를 클릭하면 Context에 저장된 현재 <code class="language-text">path(route.path)</code>와 비교해서 같지 않으면 인자로 받은 to를 <code class="language-text">history.push(to)</code>와 같은 방법으로 history에 추가해 줌으로써 현재 path를 바꿔 Route에 알려주는 역할을 한다. 인자로 받은 onClick은 단순히 onClick 함수가 있다면 해당 event 객체를 전달하기 위함이고, children은 변경 없이 Link 기능만 갖도록 하여 출력하도록 return한다.</p>
<p>여기서 중요한 것은 <code class="language-text">a</code> tag의 사용이라고 생각한다. 일반적으로 서버사이드 렌더링에서는 HTML에서 <code class="language-text">a</code> Tag를 사용해 페이지 전환을 하는데, SPA에서도 마찬가지로 <code class="language-text">a</code> Tag를 사용해 이 작업을 진행하고 있었다. 또한 page 전체 Re-loading을 막기 위해 <code class="language-text">e.preventDefault()</code>를 사용했다는 점까지, 생각보다 상당히 간단하게 구현이 가능하구나 라는 느낌을 받았다.</p>
<h3 id="4-router-component"><a href="#4-router-component" aria-label="4 router component permalink" class="anchor"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Router Component</h3>
<p>이렇게 각 컴포넌트에서 Context를 데이터를 사용하고 변경할 수 있으려면 <code class="language-text">Provider</code> 컴포넌트가 필요하다. 이와 함께 추가적인 기능을 수행하는 <code class="language-text">Router</code> 컴포넌트를 알아보자.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">import React from &quot;react&quot;;
import { locationToRoute } from &quot;./utils&quot;;
import { history, RouterContext } from &quot;./context&quot;;
import { Route } from &quot;./route&quot;;
import { Link } from &quot;./link&quot;;

class Router extends React.Component {
  constructor(props) {
    super(props);

    // Convert our routes into an array for easy 404 checking
    this.routes = Object.keys(props.routes).map((key) =&gt; props.routes[key].path);

    // Listen for path changes from the history API
    this.unlisten = history.listen(this.handleRouteChange);

    // Define the initial RouterContext value
    this.state = {
      route: locationToRoute(history.location),
    };
  }

  componentWillUnmount() {
    // Stop listening for changes if the Router component unmounts
    this.unlisten();
  }
  
  handleRouteChange = (location) =&gt; {
    const route = locationToRoute(location);
    this.setState({ route: route });
  }

  render() {
    // Define our variables
    const { children, NotFound } = this.props;
    const { route } = this.state;

    // Create our RouterContext value
    const routerContextValue = { route };

    // Check if 404 if no route matched
    const is404 = this.routes.indexOf(route.path) === -1;

    return (
      &lt;RouterContext.Provider value={routerContextValue}&gt;
        {is404 ? &lt;NotFound/&gt; : children}
      &lt;/RouterContext.Provider&gt;
    );
  }
}

export { history, RouterContext, Router, Route, Link }</code></pre></div>
<p>Router는 먼저 2개의 props를 받는데, <code class="language-text">routes list</code>와 404 에러처리에 대한 <code class="language-text">NotFound</code> 컴포넌트이다. 이 두 props는 <code class="language-text">routes list</code>로 등록할 path를 모두 확인해 해당 경로가 없을 경우 바로 <code class="language-text">NotFound</code> 컴포넌트를 출력해주기 위함이다.</p>
<p>또한 RouterContext를 통해 route 값을 각 컴포넌트에 전달하는 역할도 하고있고, <code class="language-text">history.listen</code>을 통해 현재 history의 변경을 route값으로 저장하고 있다. 마지막으로는 export로 모든 컴포넌트를 한번에 export하는 모습을 볼 수 있다.</p>
<p><code class="language-text">react-router-dom</code>을 열어보니 Context Propvider 역할을 Switch에서 하고 있으며, <code class="language-text">history</code>를 BrowserRouter에서 생성해 Router 컴포넌트로 전달하고 있었다.</p>
<p>아래는 이 Costom Router를 사용한 코드이다.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">export const routes = {
  home: {
    path: &quot;/&quot;,
  },
  about: {
    path: &quot;/about&quot;
  },
};</code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">import React from &quot;react&quot;;
import ReactDOM from &quot;react-dom&quot;;
import {Router, Link, Route, history} from &quot;./router&quot;;
import {routes} from &quot;./routes&quot;;

function NotFound() {
  return (
    &lt;div&gt;
      &lt;p&gt;404 - Not Found&lt;/p&gt;
      &lt;Link to={routes.home.path}&gt;Back to home&lt;/Link&gt;
    &lt;/div&gt;
  )
}

function App() {
  return (
    &lt;Router routes={routes} NotFound={NotFound}&gt;
      &lt;Route path={routes.home.path}&gt;
        &lt;p&gt;Home&lt;/p&gt;
        &lt;Link to={routes.about.path}&gt;Go to about&lt;/Link&gt;
        &lt;Link to=&quot;/unknown&quot;&gt;Go to unknown route&lt;/Link&gt;
        &lt;div className=&quot;link&quot; onClick={() =&gt; history.push(routes.about.path)}&gt;
          Programmatically go to about
        &lt;/div&gt;
      &lt;/Route&gt;
      &lt;Route path={routes.about.path}&gt;
        &lt;p&gt;About&lt;/p&gt;
        &lt;Link to={routes.home.path}&gt;Go to home&lt;/Link&gt;
      &lt;/Route&gt;
    &lt;/Router&gt;
  );
}

const rootElement = document.getElementById(&quot;root&quot;);
ReactDOM.render(&lt;App /&gt;, rootElement);</code></pre></div>
<hr>
<blockquote>
<p>공부한 내용을 정리하는 공간으로 학습 중 습득한 내용이 정확하지 않은 정보를 포함할 수 있어 추후 발견시 수정하도록 하겠습니다.</p>
</blockquote>
<hr></div></div></div><div class="Post-module--post__footer--1BvmJ"><div><p class="Meta-module--meta__date--3FNDv">Published <!-- -->22 Oct 2019</p></div><div class="Tags-module--tags--1oNz4"><ul class="Tags-module--tags__list--2UTD-"><li class="Tags-module--tags__list-item--b7tap"><a class="Tags-module--tags__list-item-link--1hQL0" href="/tag/router/">Router</a></li><li class="Tags-module--tags__list-item--b7tap"><a class="Tags-module--tags__list-item-link--1hQL0" href="/tag/react/">React</a></li><li class="Tags-module--tags__list-item--b7tap"><a class="Tags-module--tags__list-item-link--1hQL0" href="/tag/react-router-dom/">react-router-dom</a></li><li class="Tags-module--tags__list-item--b7tap"><a class="Tags-module--tags__list-item-link--1hQL0" href="/tag/customized-router/">customized router</a></li></ul></div><div class="Author-module--author--2kf8a"><p>A beginner of front-end developer
What I&#x27;ve learend and thought<a class="Author-module--author__bio-twitter--MufFK" href="https://www.twitter.com/#" rel="noopener noreferrer" target="_blank"></a></p></div></div><div class="Post-module--post__comments--2T8dL"><div><div id="disqus_thread"></div></div></div></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/custom-react-router";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-c3d9d4a44345fa6b1fa1.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-5efb7b8fb8a6286e0a5c.js"],"component---src-templates-not-found-template-js":["/component---src-templates-not-found-template-js-d18bc7fdbbbeafd2856e.js"],"component---src-templates-tags-list-template-js":["/component---src-templates-tags-list-template-js-a899627980e79657aebc.js"],"component---src-templates-categories-list-template-js":["/component---src-templates-categories-list-template-js-9ba81d9d590914da2a16.js"],"component---src-templates-post-template-js":["/component---src-templates-post-template-js-9494a2a4c0af5d00f4bc.js"],"component---src-templates-page-template-js":["/component---src-templates-page-template-js-dcae1941bbcdff4e1c1b.js"],"component---src-templates-tag-template-js":["/component---src-templates-tag-template-js-8c473d544c773437584c.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-c4d7ab985207e76d3069.js"],"component---src-templates-index-template-js":["/component---src-templates-index-template-js-fdacd2e055125507c333.js"]};/*]]>*/</script><script src="/component---src-templates-post-template-js-9494a2a4c0af5d00f4bc.js" async=""></script><script src="/commons-03b9a88ce9f91af71312.js" async=""></script><script src="/styles-aa840c26b1d65be8accb.js" async=""></script><script src="/app-c3d9d4a44345fa6b1fa1.js" async=""></script><script src="/netlify-identity-widget-6611d108b42a589f4dd8.js" async=""></script><script src="/webpack-runtime-1b8a18eb707690299638.js" async=""></script></body></html>